cmake_minimum_required (VERSION 2.8)

cmake_policy(SET CMP0015 NEW)

# Ignore all warnings
if(CMAKE_COMPILER_IS_GNUCXX OR ${CMAKE_CXX_COMPILER_ID} STREQUAL "Clang")
    set(CMAKE_CXX_FLAGS "-std=c++1y -w")
    set(CMAKE_C_FLAGS "-w")
endif()

if(MSVC)
    if(CMAKE_CXX_FLAGS MATCHES "/W[0-4]")
        string(REGEX REPLACE "/W[0-4]" "/W0" CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS}")
    else()
        set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} /W0")
    endif()
  
    if(CMAKE_C_FLAGS MATCHES "/W[0-4]")
        string(REGEX REPLACE "/W[0-4]" "/W0" CMAKE_C_FLAGS "${CMAKE_C_FLAGS}")
    else()
        set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} /W0")
    endif()
endif()

# Configure RadeonRays build
set(RR_EMBED_KERNELS ON CACHE BOOL "Embed CL kernels into binary module")
set(RR_ALLOW_CPU_DEVICES OFF CACHE BOOL "Allows CPU Devices")
set(RR_USE_OPENCL ON CACHE BOOL "Use OpenCL for GPU hit testing")
set(RR_USE_EMBREE OFF CACHE BOOL "Use Intel(R) Embree for CPU hit testing")
set(RR_USE_VULKAN OFF CACHE BOOL "Use vulkan for GPU hit testing")
set(RR_NO_TESTS ON CACHE BOOL "Don't add any unit tests and remove any test functionality from the library")
set(RR_ENABLE_STATIC OFF CACHE BOOL "Create static libraries rather than dynamic")
set(RR_SHARED_CALC OFF CACHE BOOL "Link Calc(compute abstraction layer) dynamically")
set(RR_ENABLE_RAYMASK ON CACHE BOOL "Enable ray masking in intersection kernels")
set(RR_TUTORIALS OFF CACHE BOOL "Add tutorials projects")
set(RR_SAFE_MATH OFF CACHE BOOL "use safe math")

#Configure Assimp build
SET(BUILD_SHARED_LIBS ON CACHE BOOL "Build package with shared libraries.")
SET(BUILD_FRAMEWORK OFF CACHE BOOL "Build package as Mac OS X Framework bundle.")
SET(ASSIMP_DOUBLE_PRECISION OFF CACHE BOOL "Set to ON to enable double precision processing")
SET(ASSIMP_OPT_BUILD_PACKAGES OFF CACHE BOOL "Set to ON to generate CPack configuration files and packaging targets")
SET(ASSIMP_ANDROID_JNIIOSYSTEM OFF CACHE BOOL "Android JNI IOSystem support is active")
SET(ASSIMP_NO_EXPORT OFF CACHE BOOL "Disable Assimp's export functionality.")
SET(ASSIMP_BUILD_ZLIB OFF CACHE BOOL "Build your own zlib")
SET(ASSIMP_BUILD_ASSIMP_TOOLS OFF CACHE BOOL "If the supplementary tools for Assimp are built in addition to the library.")
SET(ASSIMP_BUILD_SAMPLES OFF CACHE BOOL "If the official samples are built as well (needs Glut).")
SET(ASSIMP_BUILD_TESTS OFF CACHE BOOL "If the test suite for Assimp is built in addition to the library.")
SET(ASSIMP_COVERALLS OFF CACHE BOOL "Enable this to measure test coverage.")
SET(ASSIMP_WERROR OFF CACHE BOOL "Treat warnings as errors.")
SET(ASSIMP_ASAN OFF CACHE BOOL "Enable AddressSanitizer.")
SET(ASSIMP_UBSAN OFF CACHE BOOL "Enable Undefined Behavior sanitizer.")
SET(SYSTEM_IRRXML OFF CACHE BOOL "Use system installed Irrlicht/IrrXML library.")
SET(BUILD_DOCS OFF CACHE BOOL "Build documentation using Doxygen.")

add_subdirectory(glm)
add_subdirectory(soil2)
add_subdirectory(imgui)
add_subdirectory(assimp)
add_subdirectory(nativefiledialog)
add_subdirectory(RadeonRays)